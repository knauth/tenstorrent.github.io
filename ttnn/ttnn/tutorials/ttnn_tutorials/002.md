# Matrix Multiplication

## Enable program cache

Enabling the program cache will speed up the execution of operations that run repeatedly

# Configuration

## Initialize tensors a and b with random values using torch

## Matrix multiply tensor a and b

The operation will run longer the first time because the kernels need to get compiled

Re-running the operation shows significant speed up by utilizing program caching

## Inspect the layout of matrix multiplication output

As can be seen, matrix multiplication produces outputs in a tile layout. That is because itâ€™s much more efficient to use this layout for computing matrix multiplications on TensTorrent accelerators compared to a row-major layout.

And this is aslo why the logs show 2 tilize operations, as the inputs get automatically convered to the tile layout if they are in a row-major layout.

Learn more about tile layout here: TODO

## Inspect the result of the matrix multiplication

To inspect the results we will first convert to row-major layout.

## Matrix multiply tensor a and b by using more performant config

By default, matrix multiplication might not be as effecient as it could be. To speed it up further, the user can specify how many cores they want matrix multiplication to use. This can speed up the operation significantly.

Run once to compile the kernels

Enjoy a massive speed up on the subsequent runs

## Close the device
